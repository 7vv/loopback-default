# LoopBack start

The project is generated by [LoopBack](http://loopback.io).

## step1
LoopBack cli install
-`npm install loopback-cli -g`

## step2
create LoopBack server
- `lb`

## step3
모델 종류
- Model                   `기본 빈 모델`
- PersistedModel          `데이터 베이스를 사용하는 API 모델 CRUD 제공`
- ACL                     `인증 모델`
- AccessToken             `인증 토큰 모델`
- Application
- Change
- Checkpoint

create LoopBack model
- `lb model`

## step4
서버 실행하기
- `node .` or `nodemon .`   <- 사용가능

## Model connect DataSource
모델을 DataSource에 연결하기.

- lb datasource `데이터 소스 설정`
- /server/model-config.json 에서 원하는 db key값에 datasource 연결
- datasource에 사용할 수 있는 함수 사용해보기 `ex) app.models.CoffeeShop.create, update 등등..`
- 예제 API
```
 app.models.abs.create([{
      name: 'Bel Cafe',
      city: 'Vancouver'
    }, {
      name: 'Three Bees Coffee House',
      city: 'San Mateo'
    }, {
      name: 'Caffe Artigiano',
      city: 'Vancouver'
    }], function(err, abss) {
      if (err) throw err;

      console.log('Models created: \n', abss);
    });
```

## Static 웹 페이지 추가하기
API 서버로만 사용할거라서 정적 웹 페이지가 필요없지만 언젠간 사용할거 같아서 작성

- /server/middleware.json 에다가 정의한다.
```
  "files": {
    "loopback#static": {
      "params": "$!../client"
    }
  },
```
- $! 문자는 해당 파일 경로 위치를 반환함
- /client/index.html 위치에 웹 페이지 파일 작성

추가로 부팅 스크립트를 이용해 사용자 정의 라우터를 만들 수 있다.
- /server/boot/routes.js 생성 routes.js는 임의로 정할 수 있다.
- 아래 코드 작성 Express 라우터랑 같아서 설명 생략

```
module.exports = function(app) {
  //Express 기반이라서 Express 형태로 사용하면 된다.
  app.get('/ping', function(req, res) {
    res.send('pong');
  });

  const api = app.loopback.Router();
  const user = app.loopback.Router();
  api.get('/', (req, res, next) => {
    res.send('this api')
  })

  api.get('/get', (req, res, next) => {
    res.send('this get api')
  })

  user.get('/', (req, res, next) => {
    res.send('this user')
  })

  user.get('/get', (req, res, next) => {
    res.send('this get user')
  })


  app.use('/user', user)
  app.use('/api', api);
}
```




